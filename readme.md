# DreamLuckin 聊天记录分析系统

## 📖 项目简介

这是一个用 Python 写的文献聊天记录分析工具，主要用来统计和分析你的聊天记录中特定关键词（比如口头禅）的使用情况。

你可以用它来：
- 📊 统计自己或特定联系人的消息中，某些关键词出现的频率
- 🔍 查看包含关键词的消息及其上下文
- 💬 支持单聊和群聊分析
- 📁 结果自动导出为 JSON 格式，方便后续处理

## ⚠️ 重要声明

**本工具仅用于个人学习和研究目的，请勿用于商业用途或侵犯他人隐私。**

**使用本工具需要从文献客户端提取数据库文件，此过程可能涉及：**
- 对文献客户端进程的内存读取
- 数据库解密操作
- 可能被文献安全机制检测

**使用本工具存在以下风险：**
- 账号可能被文献官方检测并采取限制措施（包括但不限于临时冻结、永久封禁等）
- 建议使用小号或测试账号进行操作
- 请自行评估风险，作者不对任何后果承担责任

**请遵守相关法律法规，尊重他人隐私，仅分析自己的聊天记录。**

## 🚀 快速开始

### 第一步：解密数据库

在使用本程序之前，你需要先解密文献的数据库文件。详细的操作步骤请参考：

👉 **[数据库解密操作指南](./doc/decrypted.md)**

**所需工具**：解密过程中需要的工具文件（`DbkeyHookUI`、`wechat-dump-rs.exe` 等）已存放在 `doc/static/` 文件夹中，可以直接使用。

简单来说，你需要：
1. 获取文献的全局密钥（使用 `doc/static/` 中的 `DbkeyHookUI` 或 `app_key` 等工具）
2. 定位并备份 `message_0.db` 和联系人数据库文件
3. 使用 `doc/static/` 中的 `wechat-dump-rs.exe` 解密数据库
4. 将解密后的数据库文件路径配置到 `configs/config.json` 中

**数据库结构说明**：如果想了解文献数据库的详细结构，可以参考：

👉 **[文献数据库结构文档](./doc/wechat_4_0_0_26_table_struct.md)**

### 第二步：配置程序

编辑 `configs/config.json` 文件，配置：
- 数据库文件路径
- 要分析的联系人列表
- 关键词（口头禅）
- 时间范围等参数

详细的配置说明请参考：

👉 **[完整配置文档](./doc/arch_decipher.md#第二部分配置文件参数说明)**

### 第三步：运行程序

```bash
python main.py
```

程序会自动：
1. 读取配置文件
2. 初始化数据库连接
3. 分析聊天记录
4. 将结果保存到 `output/` 目录

### 第四步：可视化结果（可选）

分析完成后，程序会在 `output/` 目录生成 JSON 格式的结果文件。

你可以将生成的 JSON 文件上传到在线可视化平台查看分析结果：

🌐 **可视化网站**：https://dreamluckin-visualize.example.com

（将 JSON 文件内容粘贴或上传到网站，即可看到精美的数据可视化图表）

## 📚 项目架构

想深入了解项目的设计思路和实现细节？可以查看：

👉 **[项目架构与实现详解](./doc/arch_decipher.md)**

文档包含：
- 项目整体概述和主程序流程
- 配置文件参数详细说明（表格形式）
- `ChatRecordAnalyzer` 的具体实现流程
- 项目设计亮点（双模式数据库服务、并发协程优化等）

## 🎯 核心特性

- ✨ **多模式统计**：支持统计自己全部消息、自己发给目标、目标发给自己三种模式
- 🔎 **灵活匹配**：支持包含匹配和精确匹配两种关键词匹配方式
- 🔄 **上下文回溯**：自动获取关键词消息的前后 N 条上下文，方便理解语境
- ⚡ **并发优化**：使用异步协程和连接池技术，大幅提升查询性能
- 👥 **群聊支持**：支持群聊消息分析，自动翻译群聊成员昵称
- 📤 **结果导出**：分析结果自动保存为 JSON 文件

## 📁 项目结构

```
DreamLuckin/
├── main.py                    # 程序入口
├── chat_analyzer/             # 聊天记录分析器
├── parser/                    # 配置解析器
├── services/                  # 数据库服务层
├── io_put/                    # 输入输出处理
├── exceptions/                # 异常定义
├── log/                       # 日志配置
├── configs/                   # 配置文件目录
│   └── config.json
├── doc/                       # 文档目录
│   ├── arch_decipher.md      # 架构详解
│   └── decrypted.md          # 数据库解密指南
└── README.md                  # 本文件
```

## 💡 使用提示

1. **首次使用**：建议先用小号测试，熟悉流程后再用主账号
2. **数据库备份**：解密前务必备份原始数据库文件，避免数据丢失
3. **配置调整**：根据实际情况调整 `max_concurrency` 等参数，平衡性能和资源占用
4. **日志查看**：程序运行日志保存在 `log_back/` 目录，遇到问题可以查看日志

## 📝 注意事项

- 本工具仅用于个人学习和研究，请勿用于商业用途
- 请遵守相关法律法规，尊重他人隐私
- 使用本工具的风险由使用者自行承担
- 建议使用小号或测试账号进行操作

## 🎉 最后 

希望这个工具能帮你更好地了解自己的聊天习惯！如果遇到问题，可以查看日志文件或参考详细文档。

**祝大家玩得开心！** 🎊

